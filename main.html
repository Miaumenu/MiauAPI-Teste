<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MiauAPI - Sistema Completo</title>
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />
  <style>
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0; 
      font-family: "Inter", sans-serif; 
    }
    
    body { 
      background: linear-gradient(135deg, #1e1e2e, #2d2d44); 
      color: #ffffff; 
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Container Principal */
    .main-container {
      display: flex;
      min-height: 100vh;
    }

    /* Sidebar de Navega√ß√£o */
    .sidebar {
      width: 250px;
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      padding: 20px;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
    }

    .sidebar h2 {
      color: #00AAFF;
      margin-bottom: 20px;
      text-align: center;
      font-size: 1.5em;
    }

    .nav-item {
      display: block;
      padding: 12px 16px;
      margin: 8px 0;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: #ffffff;
      text-decoration: none;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .nav-item:hover {
      background: rgba(0, 170, 255, 0.2);
      border-color: #00AAFF;
      transform: translateX(5px);
    }

    .nav-item.active {
      background: rgba(0, 170, 255, 0.3);
      border-color: #00AAFF;
    }

    /* Conte√∫do Principal */
    .content {
      flex: 1;
      margin-left: 250px;
      padding: 20px;
    }

    .content-section {
      display: none;
      animation: fadeIn 0.3s ease;
    }

    .content-section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Sistema de Notifica√ß√µes */
    .notify-container {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 10px;
      z-index: 9999;
    }

    .notify {
      position: relative;
      display: flex;
      align-items: center;
      gap: 8px;
      width: 252px;
      min-height: 58px;
      padding: 10px 14px;
      background: linear-gradient(0deg, #000000, #000000);
      border: 1px solid rgba(255,255,255,0.15);
      box-shadow: 0px 0px 18px 2px rgba(0,0,0,0.4);
      border-radius: 7px;
      color: #FFFFFF;
      overflow: hidden;
      animation: slideIn 0.4s ease;
      pointer-events: all;
      cursor: pointer;
    }

    .notify p {
      font-weight: 600;
      font-size: 10px;
      line-height: 12px;
      letter-spacing: -0.02em;
      color: #FFFFFF;
      margin-left: 8px;
      text-shadow: 0 0 4px rgba(255,255,255,0.2);
    }

    .notify::before {
      content: "";
      position: absolute;
      left: 0;
      top: 6px;
      width: 3px;
      height: 46px;
      border-radius: 7px;
      box-shadow: 0px 0px 4px 2px rgba(255,255,255,0.4);
    }

    .notify.info {
      border: 1px solid rgba(0,170,255,0.71);
      box-shadow: 0px 0px 18px 2px rgba(0,170,255,0.25);
    }
    .notify.info::before {
      background: #00AAFF;
      box-shadow: 0px 0px 4px 2px rgba(0,170,255,0.61);
    }

    .notify.sucesso {
      border: 1px solid rgba(17,255,0,0.71);
      box-shadow: 0px 0px 18px 2px rgba(17,255,0,0.25);
    }
    .notify.sucesso::before {
      background: #11FF00;
      box-shadow: 0px 0px 4px 2px rgba(17,255,0,0.61);
    }

    .notify.erro {
      border: 1px solid rgba(255,0,0,0.71);
      box-shadow: 0px 0px 18px 2px rgba(255,0,0,0.25);
    }
    .notify.erro::before {
      background: #FF0000;
      box-shadow: 0px 0px 4px 2px rgba(255,0,0,0.61);
    }

    .notify.warning {
      border: 1px solid rgba(238,255,0,0.71);
      box-shadow: 0px 0px 18px 2px rgba(238,255,0,0.25);
    }
    .notify.warning::before {
      background: #EEFF00;
      box-shadow: 0px 0px 4px 2px rgba(238,255,0,0.61);
    }

    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Canvas de Desenho */
    .drawing-canvas {
      border: 2px solid #00AAFF;
      border-radius: 8px;
      background: #ffffff;
      cursor: crosshair;
      margin: 20px 0;
    }

    .drawing-controls {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .control-btn {
      padding: 10px 20px;
      background: rgba(0, 170, 255, 0.2);
      border: 1px solid #00AAFF;
      border-radius: 6px;
      color: #ffffff;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .control-btn:hover {
      background: rgba(0, 170, 255, 0.4);
    }

    .control-btn.active {
      background: #00AAFF;
    }

    /* Se√ß√£o de M√≠dia */
    .media-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin: 20px 0;
    }

    .media-item {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 20px;
      text-align: center;
    }

    .media-item h3 {
      color: #00AAFF;
      margin-bottom: 10px;
    }

    /* Formul√°rios */
    .form-group {
      margin: 15px 0;
    }

    .form-group label {
      display: block;
      margin-bottom: 5px;
      color: #ffffff;
      font-weight: 600;
    }

    .form-group input, .form-group select {
      width: 100%;
      padding: 10px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 6px;
      color: #ffffff;
    }

    .form-group input::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    /* Responsividade */
    @media (max-width: 768px) {
      .sidebar {
        width: 100%;
        height: auto;
        position: relative;
      }
      
      .content {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Sistema de Notifica√ß√µes -->
    <div class="notify-container">
      <TransitionGroup name="slide" tag="div">
        <div v-for="n in notifications"
             :key="n.id"
             class="notify"
             :class="n.level"
             @click="removeNotification(n.id)">
          <p>{{ n.message }}</p>
        </div>
      </TransitionGroup>
    </div>

    <!-- Container Principal -->
    <div class="main-container">
      <!-- Sidebar de Navega√ß√£o -->
      <div class="sidebar">
        <h2>MiauAPI</h2>
        <div class="nav-item" :class="{ active: currentSection === 'dashboard' }" @click="setSection('dashboard')">
          üìä Dashboard
        </div>
        <div class="nav-item" :class="{ active: currentSection === 'notifications' }" @click="setSection('notifications')">
          üîî Notifica√ß√µes
        </div>
        <div class="nav-item" :class="{ active: currentSection === 'drawing' }" @click="setSection('drawing')">
          üé® Desenho
        </div>
        <div class="nav-item" :class="{ active: currentSection === 'media' }" @click="setSection('media')">
          üé¨ M√≠dia
        </div>
        <div class="nav-item" :class="{ active: currentSection === 'api' }" @click="setSection('api')">
          üîß API
        </div>
      </div>

      <!-- Conte√∫do Principal -->
      <div class="content">
        <!-- Dashboard -->
        <div class="content-section" :class="{ active: currentSection === 'dashboard' }">
          <h1>Dashboard MiauAPI</h1>
          <p>Bem-vindo ao sistema completo da MiauAPI. Aqui voc√™ pode acessar todas as funcionalidades:</p>
          
          <div class="media-grid">
            <div class="media-item">
              <h3>üîî Notifica√ß√µes</h3>
              <p>Sistema de notifica√ß√µes em tempo real</p>
              <button class="control-btn" @click="setSection('notifications')">Acessar</button>
            </div>
            <div class="media-item">
              <h3>üé® Desenho</h3>
              <p>Ferramentas de desenho e canvas</p>
              <button class="control-btn" @click="setSection('drawing')">Acessar</button>
            </div>
            <div class="media-item">
              <h3>üé¨ M√≠dia</h3>
              <p>Gerenciamento de m√≠dias</p>
              <button class="control-btn" @click="setSection('media')">Acessar</button>
            </div>
            <div class="media-item">
              <h3>üîß API</h3>
              <p>Documenta√ß√£o e testes da API</p>
              <button class="control-btn" @click="setSection('api')">Acessar</button>
            </div>
          </div>
        </div>

        <!-- Se√ß√£o de Notifica√ß√µes -->
        <div class="content-section" :class="{ active: currentSection === 'notifications' }">
          <h1>Sistema de Notifica√ß√µes</h1>
          <p>Teste o sistema de notifica√ß√µes da MiauAPI:</p>
          
          <div class="drawing-controls">
            <button class="control-btn" @click="testNotification('info')">Notifica√ß√£o Info</button>
            <button class="control-btn" @click="testNotification('sucesso')">Notifica√ß√£o Sucesso</button>
            <button class="control-btn" @click="testNotification('erro')">Notifica√ß√£o Erro</button>
            <button class="control-btn" @click="testNotification('warning')">Notifica√ß√£o Warning</button>
          </div>

          <div class="form-group">
            <label>Mensagem Personalizada:</label>
            <input v-model="customMessage" placeholder="Digite sua mensagem..." />
            <button class="control-btn" @click="sendCustomNotification">Enviar</button>
          </div>
        </div>

        <!-- Se√ß√£o de Desenho -->
        <div class="content-section" :class="{ active: currentSection === 'drawing' }">
          <h1>Ferramentas de Desenho</h1>
          <p>Use as ferramentas abaixo para desenhar no canvas:</p>
          
          <div class="drawing-controls">
            <button class="control-btn" :class="{ active: drawingTool === 'line' }" @click="setDrawingTool('line')">Linha</button>
            <button class="control-btn" :class="{ active: drawingTool === 'circle' }" @click="setDrawingTool('circle')">C√≠rculo</button>
            <button class="control-btn" :class="{ active: drawingTool === 'rectangle' }" @click="setDrawingTool('rectangle')">Ret√¢ngulo</button>
            <button class="control-btn" @click="clearCanvas">Limpar</button>
            <button class="control-btn" @click="downloadCanvas">Download</button>
          </div>

          <div class="form-group">
            <label>Cor:</label>
            <input type="color" v-model="drawingColor" />
            <label>Espessura:</label>
            <input type="range" v-model="lineWidth" min="1" max="20" />
            <span>{{ lineWidth }}px</span>
          </div>

          <canvas 
            ref="drawingCanvas"
            class="drawing-canvas"
            width="800" 
            height="400"
            @mousedown="startDrawing"
            @mousemove="draw"
            @mouseup="stopDrawing"
            @mouseleave="stopDrawing">
          </canvas>
        </div>

        <!-- Se√ß√£o de M√≠dia -->
        <div class="content-section" :class="{ active: currentSection === 'media' }">
          <h1>Gerenciamento de M√≠dia</h1>
          <p>Gerencie diferentes tipos de m√≠dia:</p>
          
          <div class="media-grid">
            <div class="media-item">
              <h3>üñºÔ∏è Imagens</h3>
              <input type="file" accept="image/*" @change="handleImageUpload" />
              <div v-if="uploadedImage" style="margin-top: 10px;">
                <img :src="uploadedImage" style="max-width: 100%; max-height: 200px;" />
              </div>
            </div>
            <div class="media-item">
              <h3>üé¨ V√≠deos</h3>
              <input type="file" accept="video/*" @change="handleVideoUpload" />
              <video v-if="uploadedVideo" :src="uploadedVideo" controls style="max-width: 100%; margin-top: 10px;"></video>
            </div>
            <div class="media-item">
              <h3>üéûÔ∏è GIFs</h3>
              <input type="file" accept="image/gif" @change="handleGifUpload" />
              <img v-if="uploadedGif" :src="uploadedGif" style="max-width: 100%; max-height: 200px; margin-top: 10px;" />
            </div>
            <div class="media-item">
              <h3>üìê SVG</h3>
              <textarea v-model="svgCode" placeholder="Cole seu c√≥digo SVG aqui..." style="width: 100%; height: 100px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 6px; color: white; padding: 10px;"></textarea>
              <button class="control-btn" @click="renderSVG" style="margin-top: 10px;">Renderizar SVG</button>
              <div v-if="renderedSVG" v-html="renderedSVG" style="margin-top: 10px;"></div>
            </div>
          </div>
        </div>

        <!-- Se√ß√£o da API -->
        <div class="content-section" :class="{ active: currentSection === 'api' }">
          <h1>Documenta√ß√£o da API</h1>
          <p>Use a API global MiauAPI para integrar com seus projetos:</p>
          
          <div class="media-item">
            <h3>Exemplos de Uso:</h3>
            <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 6px; overflow-x: auto;">
// Notifica√ß√µes
MiauAPI.infobox("Mensagem de sucesso!", 5000, "medium", "top-right", "sucesso");
MiauAPI.infobox("Erro encontrado!", 3000, "medium", "top-right", "erro");
MiauAPI.infobox("Aviso importante!", 7000, "medium", "top-right", "warning");
MiauAPI.infobox("Informa√ß√£o √∫til!", 4000, "medium", "top-right", "info");

// Desenho
MiauAPI.drawing.drawLine(x1, y1, x2, y2, color, width);
MiauAPI.drawing.drawCircle(x, y, radius, color, width);
MiauAPI.drawing.drawRectangle(x, y, width, height, color, lineWidth);

// M√≠dia
MiauAPI.media.loadImage(url);
MiauAPI.media.loadVideo(url);
MiauAPI.media.loadGif(url);
            </pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp, ref, nextTick } = Vue;

    createApp({
      setup() {
        // Estado da aplica√ß√£o
        const currentSection = ref('dashboard');
        const notifications = ref([]);
        const customMessage = ref('');
        
        // Estado do desenho
        const drawingTool = ref('line');
        const drawingColor = ref('#00AAFF');
        const lineWidth = ref(2);
        const isDrawing = ref(false);
        const startX = ref(0);
        const startY = ref(0);
        const drawingCanvas = ref(null);
        
        // Estado da m√≠dia
        const uploadedImage = ref('');
        const uploadedVideo = ref('');
        const uploadedGif = ref('');
        const svgCode = ref('');
        const renderedSVG = ref('');

        // Fun√ß√µes de navega√ß√£o
        const setSection = (section) => {
          currentSection.value = section;
        };

        // Fun√ß√µes de notifica√ß√£o
        const addNotification = (message, duration = 5000, level = "info") => {
          const id = Date.now() + Math.random();
          notifications.value.push({ id, message, level });

          if (duration > 0) {
            setTimeout(() => removeNotification(id), duration);
          }
        };

        const removeNotification = (id) => {
          const idx = notifications.value.findIndex(n => n.id === id);
          if (idx !== -1) notifications.value.splice(idx, 1);
        };

        const testNotification = (type) => {
          const messages = {
            info: "Esta √© uma notifica√ß√£o informativa!",
            sucesso: "Opera√ß√£o realizada com sucesso!",
            erro: "Ocorreu um erro na opera√ß√£o!",
            warning: "Aten√ß√£o! Esta √© uma notifica√ß√£o de aviso!"
          };
          addNotification(messages[type], 5000, type);
        };

        const sendCustomNotification = () => {
          if (customMessage.value.trim()) {
            addNotification(customMessage.value, 5000, "info");
            customMessage.value = '';
          }
        };

        // Fun√ß√µes de desenho
        const setDrawingTool = (tool) => {
          drawingTool.value = tool;
        };

        const startDrawing = (event) => {
          isDrawing.value = true;
          const rect = drawingCanvas.value.getBoundingClientRect();
          startX.value = event.clientX - rect.left;
          startY.value = event.clientY - rect.top;
        };

        const draw = (event) => {
          if (!isDrawing.value) return;
          
          const rect = drawingCanvas.value.getBoundingClientRect();
          const currentX = event.clientX - rect.left;
          const currentY = event.clientY - rect.top;
          
          const ctx = drawingCanvas.value.getContext('2d');
          ctx.strokeStyle = drawingColor.value;
          ctx.lineWidth = lineWidth.value;
          ctx.lineCap = 'round';
          
          ctx.beginPath();
          ctx.moveTo(startX.value, startY.value);
          ctx.lineTo(currentX, currentY);
          ctx.stroke();
          
          startX.value = currentX;
          startY.value = currentY;
        };

        const stopDrawing = () => {
          isDrawing.value = false;
        };

        const clearCanvas = () => {
          const ctx = drawingCanvas.value.getContext('2d');
          ctx.clearRect(0, 0, drawingCanvas.value.width, drawingCanvas.value.height);
        };

        const downloadCanvas = () => {
          const link = document.createElement('a');
          link.download = 'desenho.png';
          link.href = drawingCanvas.value.toDataURL();
          link.click();
        };

        // Fun√ß√µes de m√≠dia
        const handleImageUpload = (event) => {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
              uploadedImage.value = e.target.result;
              addNotification("Imagem carregada com sucesso!", 3000, "sucesso");
            };
            reader.readAsDataURL(file);
          }
        };

        const handleVideoUpload = (event) => {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
              uploadedVideo.value = e.target.result;
              addNotification("V√≠deo carregado com sucesso!", 3000, "sucesso");
            };
            reader.readAsDataURL(file);
          }
        };

        const handleGifUpload = (event) => {
          const file = event.target.files[0];
          if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
              uploadedGif.value = e.target.result;
              addNotification("GIF carregado com sucesso!", 3000, "sucesso");
            };
            reader.readAsDataURL(file);
          }
        };

        const renderSVG = () => {
          if (svgCode.value.trim()) {
            renderedSVG.value = svgCode.value;
            addNotification("SVG renderizado com sucesso!", 3000, "sucesso");
          }
        };

        // API Global
        window.MiauAPI = {
          infobox: (msg, dur = 5000, size = "medium", pos = "top-right", level = "info") =>
            addNotification(msg, dur, level),
          drawing: {
            drawLine: (x1, y1, x2, y2, color = '#00AAFF', width = 2) => {
              const ctx = drawingCanvas.value.getContext('2d');
              ctx.strokeStyle = color;
              ctx.lineWidth = width;
              ctx.beginPath();
              ctx.moveTo(x1, y1);
              ctx.lineTo(x2, y2);
              ctx.stroke();
            },
            drawCircle: (x, y, radius, color = '#00AAFF', width = 2) => {
              const ctx = drawingCanvas.value.getContext('2d');
              ctx.strokeStyle = color;
              ctx.lineWidth = width;
              ctx.beginPath();
              ctx.arc(x, y, radius, 0, 2 * Math.PI);
              ctx.stroke();
            },
            drawRectangle: (x, y, width, height, color = '#00AAFF', lineWidth = 2) => {
              const ctx = drawingCanvas.value.getContext('2d');
              ctx.strokeStyle = color;
              ctx.lineWidth = lineWidth;
              ctx.strokeRect(x, y, width, height);
            }
          },
          media: {
            loadImage: (url) => {
              uploadedImage.value = url;
              addNotification("Imagem carregada via URL!", 3000, "sucesso");
            },
            loadVideo: (url) => {
              uploadedVideo.value = url;
              addNotification("V√≠deo carregado via URL!", 3000, "sucesso");
            },
            loadGif: (url) => {
              uploadedGif.value = url;
              addNotification("GIF carregado via URL!", 3000, "sucesso");
            }
          }
        };

        // Recebe mensagens do Lua via SendDuiMessage
        window.addEventListener("message", (event) => {
          let data = event.data;
          try { 
            if (typeof data === "string") data = JSON.parse(data); 
          } catch (e) {}

          if (!data || data.action !== "notify") return;
          addNotification(
            data.message || "Sem mensagem",
            data.duration || 5000,
            data.level || "info"
          );
        });

        return {
          currentSection,
          notifications,
          customMessage,
          drawingTool,
          drawingColor,
          lineWidth,
          drawingCanvas,
          uploadedImage,
          uploadedVideo,
          uploadedGif,
          svgCode,
          renderedSVG,
          setSection,
          addNotification,
          removeNotification,
          testNotification,
          sendCustomNotification,
          setDrawingTool,
          startDrawing,
          draw,
          stopDrawing,
          clearCanvas,
          downloadCanvas,
          handleImageUpload,
          handleVideoUpload,
          handleGifUpload,
          renderSVG
        };
      }
    }).mount("#app");
  </script>
</body>
</html>
